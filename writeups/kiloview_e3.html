<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Darrin Jackson | Cybersecurity Portfolio</title>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
  <style>
    @font-face {
      font-family: 'Molot';
      src: url('/fonts/molot.otf') format('opentype');
      font-weight: normal;
      font-style: normal;
    }
    body {
      font-family: 'Fira Code', monospace;
      background-color: #0a0a0a;
      color: #e0e0e0;
      margin: 0;
      padding: 0;
    }
    header, footer {
      background-color: #111;
      padding: 1rem;
      text-align: center;
    }
    nav a {
      margin: 0 1rem;
      color: #a962e8;
      text-decoration: none;
      padding: 0.75rem 1rem; 
      font-size: 1.1rem;     
    }
    main {
      padding: 2rem;
      max-width: 800px;
      margin: auto;
    }
    h1, h2 {
      font-family: 'Molot', 'Fira Code', monospace;
      color: #a962e8;
    }
    nav {
      display: flex;
      justify-content: center;
      background-color: #111;
      font-size: 1.1rem;
      gap: 2rem;       
      padding: 1rem;   
    }
  
  .dropdown {
    position: relative;
    display: inline-block;
    }
  
  .dropdown-content {
    display: none;
    position: absolute;
    background-color: #222;
    min-width: 160px;
    z-index: 1;
    text-align: left;
    border: 1px solid #333;
    }
  
  .dropdown-content a {
    color: #a962e8;
    padding: 0.75rem 1rem;
    font-size: 1rem;
    display: block;
    text-decoration: none;
    }
  
  .dropdown-content a:hover {
    background-color: #333;
    }
  
    .dropdown .dropdown-content {
    display: none;
  }
  
  .dropdown.open .dropdown-content {
    display: block;
  }

@media (max-width: 768px) {
  nav {
    flex-direction: column;
    align-items: center;
  }

  .dropdown-content {
    position: static;       /* stack vertically instead of absolute */
    border: none;
    box-shadow: none;
  }

  .dropdown:hover .dropdown-content {
    display: block;
  }

  nav a, .dropdown-content a {
    width: 100%;
    text-align: center;
  }
  .nav-item {
    display: inline-block;
    position: relative;
    padding: 0.75rem 1rem;
  }

}


  </style>
</head>
<body>
  <header>
    <h1>Darrin Jackson</h1>
<nav>
  <div class="nav-item">
    <a href="/">Home</a>
  </div>

  <div class="dropdown">
    <a href="#">Projects</a>
    <div class="dropdown-content">
      <a href="/builds/">Builds &#11146</a> <!--build this dir-->
      <a href="/scripts/">Scripts &#11146</a> <!--build this dir-->
      <a href="/projects/">Homelab & Network &#11146</a>
    </div>
  </div>

  <div class="dropdown">
    <a href="#">Writeups</a>
    <div class="dropdown-content">
      <a href="/writeups/">Vuln Discoveries/CVEs &#11146</a>
      <a href="/reports/">Professional Reports &#11146</a> <!--build this dir-->
      <a href="/ctfs/">CTFs &#11146</a>
    </div>
  </div>

  <div class="dropdown">
    <a href="#">About Me</a>
    <div class="dropdown-content">
      <a href="/certifications/">Credentials &#11146</a>
      <a href="/resume/">Resume &#11146</a>
      <a href="/contact/">Contact &#11146</a>
    </div>
  </div>
</nav>
    
  </header>
  <main>
<h2>Unauthenticated Factory Reset Vulnerability in Kiloview E3 Video Encoder</h2>
<p>
Confirmed for Software Version 1.20.0006
</p>

  <h3>Summary</h3>
  <p>
    An unauthenticated API endpoint on Kiloview E3 video encoders allowed remote attackers to trigger a factory reset without any credentials or prior authentication. If the device remained reachable after the reset, it was accessible via default credentials, allowing full dashboard and video feed access.
  </p>
   
<h3>Timeline</h3>
  <table border="1" cellpadding="6" cellspacing="0" style="width:100%; border-collapse: collapse; background-color:#111; color:#e0e0e0;">
  <thead>
    <tr style="background-color:#222;">
      <th>Date</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
      Sunday, April 6th, 2025
      </td>
      <td>
      Vulnerability and Exploit Discovered
      </td>
    </tr>
      <tr>
      <td>
      Monday, April 7th, 2025
      </td>
      <td>
      CVE Request submitted to MITRE
      </td>
    </tr>
    <tr>
      <td>
      Monday, April 7th, 2025
      </td>
      <td>
      Vulnerability and Exploit Disclosed to Vendor
      </td>
    </tr>
    <tr>
      <td>
      Tuesday, April 8th, 2025
      </td>
      <td>
      Vendor Acknowledgement and Start of Vendor Triage
      </td>
    </tr>
    <tr>
      <td>
      Monday, July 21st, 2025
      </td>
      <td>
      Vendor Patched Vulnerability
      </td>
    </tr>
    <tr>
      <td>
      Friday, July 25th, 2025
      </td>
      <td>
      Vulnerability and Exploit Publicly Disclosed
      </td>
    </tr>
    <tr>
      <td>
      TBD
      </td>
      <td>
      CVE Assigned
      </td>
    </tr>
  </tbody>
</table>
    
<h3>Device Discovery</h3>
<p>
While performing passive recon, I located a Kilview E3 encoder with a publicly exposed login portal.
</p>
  <!-- login   -->
  <img src="/images/e3login.png" alt="Pi-hole Admin Dashboard" style="width:100%; margin-top: 1.5rem; border: 1px solid #333; border-radius: 8px;">

<h3>Reconnaissance of Web Interface</h3>
<p>
  Inspecting the login page's source revealed a linked JavaScript file, which most likely was responsible for the web application logic.
</p> 
    <!-- curl   -->
  <img src="/images/e3curl.png" alt="Pi-hole Admin Dashboard" style="width:100%; margin-top: 1.5rem; border: 1px solid #333; border-radius: 8px;">
  
<h3>Application Logic and API Discovery</h3>
<p>
  The JavaScript was viewable within a web browser by going to the URL path associated with it. This led me to discover that the web application called API functions through specific URL addresses. The application uses a JavaScript-defined variable proxyUrl, pointing to [device_ip]/api/, as the base for its internal API calls.
</p>

 <!-- proxy url api format   -->
  <img src="/images/e3apiformat.png" alt="Pi-hole Admin Dashboard" style="width:100%; margin-top: 1.5rem; border: 1px solid #333; border-radius: 8px;">
 
<h3>Identification of Vulnerable Endpoints</h3>
<p>
Following this API URL definition were a series of API functions with their respective URLs to call them. Some functions had parameter values that were handled in their execution. However, functions with no parameters could be called without any authorization, which includes the factory reset function "systemctrl/system/reFactory".
</p>
 <!-- factory reset API   -->
  <img src="/images/e3refactory.png" alt="Pi-hole Admin Dashboard" style="width:100%; margin-top: 1.5rem; border: 1px solid #333; border-radius: 8px;">

<h3>Exploitation</h3>
<p>
Using the documented endpoint, I crafted a direct API call to the factory reset function. Submitting this request via a browser confirmed successful execution with a status response of result: ok.
</p>
 <!-- confirmed reset   -->
  <img src="/images/e3efactoryconfirm.png" alt="Pi-hole Admin Dashboard" style="width:100%; margin-top: 1.5rem; border: 1px solid #333; border-radius: 8px;">
  
<h3>Post Exploitation</h3>
<p>
After factory resetting the device, I have observed two possible outcomes.
</p>
<p>
The most common outcome is that the device is no longer reachable post factory reset. Assuming that the reset erases a specific configuration or setting that had initially made it publicly accessible.
</p>
<p>
The other outcome is that the device is still accessible remotely, which allows the attacker to use the default credentials to log in. Giving the attacker full administrative access to the device.
</p>
 <!-- post exploit    -->
  <img src="/images/e3postexploit.png" alt="Pi-hole Admin Dashboard" style="width:100%; margin-top: 1.5rem; border: 1px solid #333; border-radius: 8px;">
  

<h3>Skills and Knowledge Developed</h3>
<ul>
  <li><strong>Real-World Reconnaissance and Target Profiling:</strong> Conducted passive reconnaissance to identify exposed assets and performed structured analysis of the login pageâ€™s front-end logic to uncover embedded references to backend application components.</li>

  <li><strong>API Enumeration Through JavaScript Reverse Engineering:</strong> Analyzed obfuscated client-side JavaScript to extract API route structures and access patterns, enabling direct interaction with undocumented endpoints outside of intended workflows.</li>

  <li><strong>Manual Payload Construction and Endpoint Validation:</strong> Constructed and executed HTTP requests targeting API endpoints to evaluate authentication controls and endpoint behavior without relying on automated scanners or fuzzers.</li>

  <li><strong>Dynamic Behavior Assessment in Uncontrolled Environments:</strong> Observed and documented inconsistent device responses post-exploitation, developing an understanding of how deployment variables and configuration states can affect vulnerability outcomes in production systems.</li>

  <li><strong>Responsible Disclosure Process Execution:</strong> Engaged with the vendor directly to report findings, provided reproduction details, and collaborated through the patch lifecycle. Coordinated vulnerability disclosure in parallel with the CVE assignment process to ensure ethical handling.</li>

  <li><strong>Professional Communication and Stakeholder Coordination:</strong> Navigated multi-month communication with vendor representatives and maintained clear technical documentation throughout. This reinforced the value of persistence, clarity, and structure when working with external security stakeholders.</li>
</ul>

  </main>
  <footer>
    &copy; 2025 Darrin Jackson
  </footer>
  <script>
  document.querySelectorAll('.dropdown > a').forEach(link => {
    link.addEventListener('click', function (e) {
      e.preventDefault();
      const open = this.parentElement.classList.contains('open');
      
      // Close all dropdowns first
      document.querySelectorAll('.dropdown').forEach(drop => drop.classList.remove('open'));

      // Open clicked one if it wasn't already open
      if (!open) {
        this.parentElement.classList.add('open');
      }
    });
  });
</script>
</body>
</html>
